/*! skmeans 2020-04-09 */

"use strict";function _toConsumableArray(r){return _arrayWithoutHoles(r)||_iterableToArray(r)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(r){if(Symbol.iterator in Object(r)||"[object Arguments]"===Object.prototype.toString.call(r))return Array.from(r)}function _arrayWithoutHoles(r){if(Array.isArray(r)){for(var t=0,n=new Array(r.length);t<r.length;t++)n[t]=r[t];return n}}!function a(i,f,s){function u(t,r){if(!f[t]){if(!i[t]){var n="function"==typeof require&&require;if(!r&&n)return n(t,!0);if(c)return c(t,!0);var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}var o=f[t]={exports:{}};i[t][0].call(o.exports,function(r){return u(i[t][1][r]||r)},o,o.exports,a,i,f,s)}return f[t].exports}for(var c="function"==typeof require&&require,r=0;r<s.length;r++)u(s[r]);return u}({1:[function(t,n,e){(function(){this.skmeans;var r=t("./main.js");void 0!==e&&(void 0!==n&&n.exports&&(e=n.exports=r),e.skmeans=r),"undefined"!=typeof window&&(window.skmeans=r)}).call(this)},{"./main.js":4}],2:[function(r,t,n){t.exports={eudist:function(r,t){for(var n=r.length,e=0,o=0;o<n;o++){var a=(r[o]||0)-(t[o]||0);e+=a*a}return e},mandist:function(r,t){for(var n=r.length,e=0,o=0,a=0;a<n;a++)e+=0<=(o=(r[a]||0)-(t[a]||0))?o:-o;return e},dist:function(r,t,n){var e=Math.abs(r-t);return n?e:e*e}}},{}],3:[function(r,t,n){var e=r("./distance.js"),x=e.eudist;e.dist;t.exports={kmrand:function(r,t){for(var n={},e=[],o=t<<2,a=r.length,i=0<r[0].length;e.length<t&&0<o--;){var f=r[Math.floor(Math.random()*a)],s=i?f.join("_"):"".concat(f);n[s]||(n[s]=!0,e.push(f))}if(e.length<t)throw new Error("Error initializating clusters");return e},kmpp:function(r,t,n){var e=x,o=n.filter(function(r){return 0<r.length}),a=r.length,i=o.length;if(0==o.length){var f=r[Math.floor(Math.random()*a)];o.push(f)}for(;o.length<t;){for(var s=[],u=o.length,c=0,v=[],l=0;l<a;l++){for(var h=1/0,d=0;d<u;d++){var p=e(r[l],o[d]);p<=h&&(h=p)}s[l]=h}for(var g=0;g<a;g++)c+=s[g];for(var m=0;m<a;m++)v[m]={i:m,v:r[m],pr:s[m]/c,cs:0};v.sort(function(r,t){return r.pr-t.pr}),v[0].cs=v[0].pr;for(var y=1;y<a;y++)v[y].cs=v[y-1].cs+v[y].pr;for(var w=Math.random(),b=0;b<a-1&&v[b++].cs<w;);o.push(v[b-1].v)}for(var j=0,k=0;k<n.length;k++)0==n[k].length&&(n[k]=o[i+j],j++);return n}}},{"./distance.js":2}],4:[function(r,t,n){var e=r("./distance.js"),o=r("./kinit.js"),K=e.eudist,P=(e.mandist,e.dist,o.kmrand,o.kmpp);function Q(r,t,n){n=n||[];for(var e=0;e<r;e++)n[e]=t;return n}function R(r,t){for(var n=this.centroids,e=n.length,o=1/0,a=0,i=0;i<e;i++){var f=t?t(r,n[i]):K(r,n[i]);f<=o&&(o=f,a=i)}return{idx:a,centroid:n[a]}}t.exports=function(r,t,n,e){for(var o=[],a=[],i=[],f=[],s=!1,u=n||1e4,c=r.length,v=r[0].length,l=[],h=0;h<t;h++)o[h]=[],l[h]=0;if(e){for(var d=_toConsumableArray(new Set(e)).sort().slice(1),p=new Set(d),g=[],m=0;m<t;m++)g[m]=Q(v,0,g[m]);for(var y=0;y<c;y++)if(-1!=e[y]){for(var w=e[y],b=g[w],j=r[y],k=0;k<v;k++)b[k]+=j[k];l[w]++}for(var x=0;x<t;x++)if(p.has(x))for(var _=o[x],A=g[x],M=l[x],S=0;S<v;S++)_[S]=A[S]/M||0}else e=Q(c,-1),d=[],p=new Set;P(r,t,o);do{Q(t,0,l);for(var E=0;E<c;E++){var O=1/0,q=0;if(-1==e[E])for(var T=0;T<t;T++)(f=K(r[E],o[T]))<=O&&(O=f,q=T);else q=e[E];l[i[E]=q]++}g=[],a=[];for(var C=0;C<t;C++)g[C]=Q(v,0,g[C]),a[C]=o[C];for(var I=0;I<t;I++)p.has(I)||(o[I]=[]);for(var D=0;D<c;D++)for(var H=g[i[D]],N=r[D],U=0;U<v;U++)H[U]+=N[U];s=!0;for(var W=0;W<t;W++)if(!p.has(W)){for(var z=o[W],F=g[W],L=a[W],B=l[W],G=0;G<v;G++)z[G]=F[G]/B||0;if(s)for(var J=0;J<v;J++)if(L[J]!=z[J]){s=!1;break}}s=s||--u<=0}while(!s);return{it:(n||1e4)-u,k:t,idxs:i,centroids:o,test:R}}},{"./distance.js":2,"./kinit.js":3}]},{},[1]);