/*! skmeans 2021-03-03 */

"use strict";function _toConsumableArray(r){return _arrayWithoutHoles(r)||_iterableToArray(r)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(r){if(Symbol.iterator in Object(r)||"[object Arguments]"===Object.prototype.toString.call(r))return Array.from(r)}function _arrayWithoutHoles(r){if(Array.isArray(r)){for(var t=0,n=new Array(r.length);t<r.length;t++)n[t]=r[t];return n}}!function i(a,f,s){function u(t,r){if(!f[t]){if(!a[t]){var n="function"==typeof require&&require;if(!r&&n)return n(t,!0);if(c)return c(t,!0);var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}var o=f[t]={exports:{}};a[t][0].call(o.exports,function(r){return u(a[t][1][r]||r)},o,o.exports,i,a,f,s)}return f[t].exports}for(var c="function"==typeof require&&require,r=0;r<s.length;r++)u(s[r]);return u}({1:[function(t,n,e){(function(){this.skmeans;var r=t("./main.js");void 0!==e&&(void 0!==n&&n.exports&&(e=n.exports=r),e.skmeans=r),"undefined"!=typeof window&&(window.skmeans=r)}).call(this)},{"./main.js":4}],2:[function(r,t,n){t.exports={eudist:function(r,t){for(var n=r.length,e=0,o=0;o<n;o++){var i=(r[o]||0)-(t[o]||0);e+=i*i}return e},mandist:function(r,t){for(var n=r.length,e=0,o=0,i=0;i<n;i++)e+=0<=(o=(r[i]||0)-(t[i]||0))?o:-o;return e},dist:function(r,t,n){var e=Math.abs(r-t);return n?e:e*e}}},{}],3:[function(r,t,n){var e=r("./distance.js"),j=e.eudist;e.dist;t.exports={kmrand:function(r,t){for(var n={},e=[],o=t<<2,i=r.length,a=0<r[0].length;e.length<t&&0<o--;){var f=r[Math.floor(Math.random()*i)],s=a?f.join("_"):"".concat(f);n[s]||(n[s]=!0,e.push(f))}if(e.length<t)throw new Error("Error initializating clusters");return e},kmpp:function(r,t,n){var e=j,o=n.filter(function(r){return 0<r.length}),i=r.length,a=o.length;if(0==o.length){var f=r[Math.floor(Math.random()*i)];o.push(f)}for(;o.length<t;){for(var s=[],u=o.length,c=0,l=[],v=0;v<i;v++){for(var h=1/0,d=0;d<u;d++){var p=e(r[v],o[d]);p<=h&&(h=p)}s[v]=h}for(var g=0;g<i;g++)c+=s[g];for(var m=0;m<i;m++)l[m]={i:m,v:r[m],pr:s[m]/c,cs:0};l.sort(function(r,t){return r.pr-t.pr}),l[0].cs=l[0].pr;for(var y=1;y<i;y++)l[y].cs=l[y-1].cs+l[y].pr;for(var w=Math.random(),b=0;b<i-1&&l[b++].cs<w;);o.push(l[b-1].v)}for(var k=0,x=0;x<n.length;x++)0==n[x].length&&(n[x]=o[a+k],k++);return n}}},{"./distance.js":2}],4:[function(r,t,n){var e=r("./distance.js"),o=r("./kinit.js"),K=e.eudist,P=(e.mandist,e.dist,o.kmrand,o.kmpp);function Q(r,t,n){n=n||[];for(var e=0;e<r;e++)n[e]=t;return n}function R(r,t){for(var n=this.centroids,e=n.length,o=1/0,i=0,a=0;a<e;a++){var f=t?t(r,n[a]):K(r,n[a]);f<=o&&(o=f,i=a)}return{idx:i,centroid:n[i]}}t.exports=function(r,t,n,e){if(e||(e=r.map(function(r){return-1})),!e.some(function(r){return-1===r}))return{it:0,k:t,idxs:e,centroids:[],test:R};if(1===r.length)return{it:0,k:t,idxs:[0],centroids:[],test:R};for(var o=[],i=[],a=[],f=[],s=!1,u=n||1e4,c=r.length,l=r[0].length,v=[],h=0;h<t;h++)o[h]=[],v[h]=0;if(e){for(var d=_toConsumableArray(new Set(e)).sort().slice(1),p=new Set(d),g=[],m=0;m<t;m++)g[m]=Q(l,0,g[m]);for(var y=0;y<c;y++)if(-1!=e[y]){for(var w=e[y],b=g[w],k=r[y],x=0;x<l;x++)b[x]+=k[x];v[w]++}for(var j=0;j<t;j++)if(p.has(j))for(var _=o[j],A=g[j],M=v[j],S=0;S<l;S++)_[S]=A[S]/M||0}else e=Q(c,-1),d=[],p=new Set;P(r,t,o);do{Q(t,0,v);for(var E=0;E<c;E++){var O=1/0,q=0;if(-1==e[E])for(var T=0;T<t;T++)(f=K(r[E],o[T]))<=O&&(O=f,q=T);else q=e[E];v[a[E]=q]++}g=[],i=[];for(var C=0;C<t;C++)g[C]=Q(l,0,g[C]),i[C]=o[C];for(var I=0;I<t;I++)p.has(I)||(o[I]=[]);for(var D=0;D<c;D++)for(var H=g[a[D]],N=r[D],U=0;U<l;U++)H[U]+=N[U];s=!0;for(var W=0;W<t;W++)if(!p.has(W)){for(var z=o[W],F=g[W],L=i[W],B=v[W],G=0;G<l;G++)z[G]=F[G]/B||0;if(s)for(var J=0;J<l;J++)if(L[J]!=z[J]){s=!1;break}}s=s||--u<=0}while(!s);return{it:(n||1e4)-u,k:t,idxs:a,centroids:o,test:R}}},{"./distance.js":2,"./kinit.js":3}]},{},[1]);